<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsubscribe</title>
</head>
<body>
    <h1>Unsubscribe from Our Mailing List</h1>

    <form id="unsubscribeForm" action="/unsubscribe" method="POST">
        <label for="email">Email Address:</label>
        <input type="email" id="email" name="email" readonly required>
        <button type="submit">Confirm Unsubscribe</button>
    </form>

    <script>
        // Helper function to get URL parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Helper function to get cookie value
        function getCookie(name) {
            let cookieArr = document.cookie.split(";");
            for(let i = 0; i < cookieArr.length; i++) {
                let cookiePair = cookieArr[i].split("=");
                if(name == cookiePair[0].trim()) {
                    return decodeURIComponent(cookiePair[1]);
                }
            }
            return null;
        }

        // Populate the email field
        function populateEmailField() {
            let email = getQueryParam('email') || getCookie('userEmail');
            if (email) {
                document.getElementById('email').value = email;
            } else {
                alert("Email address not found.");
            }
        }

        // Run the function to populate the email field on page load
        window.onload = populateEmailField;
    </script>
</body>
</html>
